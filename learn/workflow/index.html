<!doctype html><html><head><link rel=stylesheet href=https://mbaldessari.github.io/hcp-new-docs/sass/patternfly.css><link rel=stylesheet href=https://mbaldessari.github.io/hcp-new-docs/sass/patternfly-addons.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/solid.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/fontawesome.css><title>Workflow | Hybrid Cloud Patterns</title></head><body><div class=pf-c-page><header class=pf-c-page__header><div class=pf-c-page__header-brand><a href=/hcp-new-docs/ class=pf-c-page__header-brand-link><img src=/images/hybrid_cloud_patterns.png alt="Hybrid Cloud Patterns"></a></div><div class=pf-c-page__header-tools><nav class="pf-c-nav pf-m-horizontal" role=navigation><ul class=pf-c-nav__list><li class=pf-c-nav__item><a class=pf-c-nav__link href=/hcp-new-docs/patterns/ title=Patterns>Get Patterns</a></li><li class="pf-c-nav__item pf-m-current"><a class=pf-c-nav__link href=/hcp-new-docs/learn/ title=Learn>Learn</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/hcp-new-docs/contribute/ title=Contribute>Contribute</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/hcp-new-docs/blog/ title=Blog>Blog</a></li></ul></nav></div></header><div class=pf-c-page__sidebar><div class=pf-c-page__sidebar-body><div class=pf-c-nav><ul class=pf-c-nav__list><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/what-are-hybrid-cloud-patterns/ class=pf-c-nav__link>What are Hybrid Cloud Patterns?</a></li><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/ocp-cluster-general-sizing/ class=pf-c-nav__link>OpenShift General Sizing</a></li><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/rhel-for-edge-general-sizing/ class=pf-c-nav__link>RHEL for Edge General Sizing</a></li><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/workflow/ class=pf-c-nav__link>Workflow</a></li><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/faq/ class=pf-c-nav__link>FAQ</a></li><li class=pf-c-nav__item><a href=/hcp-new-docs/learn/test-assembly/ class=pf-c-nav__link>Test Assembly</a></li></ul></div></div></div><main class=pf-c-page__main><section class=pf-c-page__main-section><div class="pf-l-grid pf-m-gutter"><div class="pf-l-grid__item pf-m-8-col"><div class=pf-c-content><h1>Workflow</h1><div class=pf-c-content><p>These patterns are designed to be composed of multiple components, and for those components to be used in gitops
workflows by consumers and contributors. To use the first pattern as an example, we maintain the <a href=industrial-edge>Industrial Edge</a> pattern, which uses a <a href=https://github.com/hybrid-cloud-patterns/industrial-edge>repo</a> with pattern-specific logic and configuration as well as a <a href=https://github.com/hybrid-cloud-patterns/common>common repo</a> which has elements common to multiple patterns. The common repo is included in each pattern repo as a submodule. This allows
consumers of the pattern flexibility to in both repos, or neither, as it suits their needs.</p><h2 id=consuming-a-pattern>Consuming a pattern</h2><ol><li><p>Fork the pattern repo on GitHub to your workspace (GitHub user or organization). It is necessary to fork because your fork will be updated as part of the GitOps and DevOps processes, and the main branch (by default) will be used in the automated workflows.</p></li><li><p>Clone the forked copy</p><p><code>git clone --recurse-submodules git@github.com:&lt;your-workspace>/industrial-edge.git</code></p></li><li><p>Create a local copy of the Helm values file that can safely include credentials</p></li></ol><p>DO NOT COMMIT THIS FILE
You do not want to push personal credentials to GitHub.</p><pre tabindex=0><code>cp values-secret.yaml.template ~/values-secret.yaml
vi ~/values-secret.yaml
</code></pre><ol><li><p>Customize the deployment for your cluster</p><pre tabindex=0><code>vi values-global.yaml
git commit values-global.yaml
git push
</code></pre></li></ol><h2 id=contributing>Contributing</h2><p>For contributions, we recommend adding the upstream repository as an additional remote, and making changes on a
branch other than main. Changes on this branch can then be merged to the <code>main</code> branch (to be reflected in the GitOps
workflows) and will be easier to make upstream, if you wish. Contributions from your forked <code>main</code> branch will contain, by design:</p><ol><li>Customizations to <code>values-global.yaml</code> and other files that are particular to your installation</li><li>Commits made by Tekton and other automated processes that will be particular to your installation</li></ol><p>To isolate changes for upstreaming (<code>hcp</code> is &ldquo;Red Hat Validated Patterns&rdquo;, you can use a different remote and/or branch name
if you want):</p><pre tabindex=0><code>git remote add hcp https://github.com/hybrid-cloud-patterns/industrial-edge
git fetch --all
git branch -b hcp-main -t hcp/main
&lt;make changes on the hcp-main branch&gt;
git push origin hcp-main
</code></pre><p>To update branch <code>hcp-main</code> with upstream changes:</p><pre tabindex=0><code>git checkout hcp-main
git pull --rebase
</code></pre><p>To reflect these changes in your forked repo (such as if you would like to submit a PR later):</p><pre tabindex=0><code>git push origin hcp-main
</code></pre><p>If you want to integrate upstream pattern changes into your local GitOps process:</p><pre tabindex=0><code>git checkout main
git merge hcp-main
git push origin main
</code></pre><p>Using this workflow, the <code>hcp-main</code> branch will:</p><ol><li>Be isolated from any changes that are being made by your local GitOps processes</li><li>Be merge-able (or cherry-pick-able) into your local main branch to be used by your local GitOps processes
(this is especially useful for tracking when any submodules, like common, update)</li><li>Be a good basis for submitting Pull Requests to be integrated upstream, since it will not contain your local configuration differences or your local GitOps commits</li></ol><h2 id=working-with-submodules>Working with submodules</h2><p>Our patterns use the git submodules feature as a mechanism to promote modularity, so that multiple patterns can use the
same common basis. Over time we will move more functionality into common, to isolate the components that are
particular to each pattern, and standard usage conventions emerge. This will make the tools in common more powerful and featureful, and make it easier to develop new patterns.</p><p>The most straightforward use of submodules is to track the version that the upstream repository is using. This can be
done by cloning the repository initially with the <code>--recurse-submodules</code> option:</p><pre tabindex=0><code>git clone --recurse-submodules https://github.com/&lt;your-workspace&gt;/industrial-edge
</code></pre><p>If you want to track a different fork of a submodule (and push use it in your GitOps environment):</p><pre tabindex=0><code>git submodule set-url common https://github.com/&lt;your-workspace&gt;/common
git commit -m &#34;Changing URL for common submodule&#34;
git push origin main
</code></pre><p>If you want to track a different branch of the forked submodule (other than the default, <code>main</code>):</p><pre tabindex=0><code>git submodule set-branch --branch &lt;target-branch&gt; common
git commit -m &#34;Changing branch to &lt;target-branch&gt; for common submodule&#34;
git push origin main
</code></pre><p>Since the GitOps workflows do not touch the common/ subdirectory of the patterns, changing the URL and tracking <code>main</code>
should be acceptable for tracking upstream and proposing changes.</p></div></div></div><div class="pf-l-grid__item pf-m-4-col"><nav class="pf-c-jump-links pf-m-vertical" aria-label=Contents><div class=pf-c-jump-links__main><div class=pf-c-jump-links__header><div class=pf-c-jump-links__label><h1>Table of Contents</h1></div></div><nav id=TableOfContents><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#consuming-a-pattern>Consuming a pattern</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#contributing>Contributing</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#working-with-submodules>Working with submodules</a></li></ul></li></ul></nav></div></nav></div></div></section></main></div><div><div style=padding:10px;text-align:center;color:#d2d2d2;background-color:#000>Copyright &copy; 2022 Red Hat, Inc.</div></div></body></html>